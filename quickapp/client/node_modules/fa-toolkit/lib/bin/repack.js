"use strict";function _0x2679(r,t){var e=_0x5a73();return(_0x2679=function(r,t){return e[r-=174]})(r,t)}var _0x33f082=_0x2679;function _typeof(r){var e=_0x2679;return(_typeof=e(197)==typeof Symbol&&e(273)==typeof Symbol.iterator?function(r){return typeof r}:function(r){var t=e;return r&&t(197)==typeof Symbol&&r[t(209)]===Symbol&&r!==Symbol[t(223)]?t(273):typeof r})(r)}function _regeneratorRuntime(){var f=_0x2679,u=(_regeneratorRuntime=function(){return u},{}),r=Object[f(223)],s=r[f(311)],t=f(197)==typeof Symbol?Symbol:{},a=t[f(314)]||f(214),e=t[f(239)]||f(304),n=t[f(299)]||f(295);function i(r,t,e){return Object[f(303)](r,t,{value:e,enumerable:!0,configurable:!0,writable:!0}),r[t]}try{i({},"")}catch(r){i=function(r,t,e){return r[t]=e}}function c(r,t,e,n){var i,a,o,u,c,s=f,t=t&&t[s(223)]instanceof l?t:l,t=Object[s(268)](t[s(223)]),n=new k(n||[]);return t[s(300)]=(i=r,a=e,o=n,c=(u=s)(233),function(r,t){var e=u;if(e(192)===c)throw new Error(e(283));if(e(226)===c){if("throw"===r)throw t;return b()}for(o[e(221)]=r,o.arg=t;;){var n=o[e(236)];if(n){n=function r(t,e){var n=f,i=t[n(314)][e[n(221)]];if(void 0===i){if(e[n(236)]=null,"throw"===e[n(221)]){if(t.iterator[n(200)]&&(e.method=n(200),e.arg=void 0,r(t,e),n(207)===e[n(221)]))return p;e.method=n(207),e[n(242)]=new TypeError(n(187))}return p}i=h(i,t.iterator,e.arg);if(n(207)===i.type)return e[n(221)]=n(207),e[n(242)]=i[n(242)],e[n(236)]=null,p;i=i.arg;return i?i[n(210)]?(e[t[n(211)]]=i[n(260)],e[n(188)]=t[n(229)],n(200)!==e[n(221)]&&(e[n(221)]="next",e[n(242)]=void 0),e[n(236)]=null,p):i:(e[n(221)]="throw",e[n(242)]=new TypeError(n(224)),e[n(236)]=null,p)}(n,o);if(n){if(n===p)continue;return n}}if("next"===o[e(221)])o[e(177)]=o[e(277)]=o[e(242)];else if(e(207)===o[e(221)]){if(e(233)===c)throw c=e(226),o.arg;o.dispatchException(o[e(242)])}else"return"===o.method&&o[e(271)]("return",o.arg);c=e(192);n=h(i,a,o);if(e(319)===n[e(324)]){if(c=o[e(210)]?e(226):e(289),n.arg===p)continue;return{value:n.arg,done:o[e(210)]}}e(207)===n[e(324)]&&(c="completed",o[e(221)]="throw",o.arg=n[e(242)])}}),t}function h(r,t,e){var n=f;try{return{type:n(319),arg:r[n(235)](t,e)}}catch(r){return{type:n(207),arg:r}}}u[f(274)]=c;var p={};function l(){}function o(){}function v(){}var t={},g=(i(t,a,function(){return this}),Object[f(307)]),g=g&&g(g(w([]))),y=(g&&g!==r&&s[f(235)](g,a)&&(t=g),v[f(223)]=l[f(223)]=Object[f(268)](t));function _(r){var t=f;[t(188),t(207),t(200)][t(280)](function(t){i(r,t,function(r){return this[_0x2679(300)](t,r)})})}function d(u,c){var t;this[f(300)]=function(e,n){function r(){return new c(function(r,t){!function t(r,e,n,i){var a,o=_0x2679,r=h(u[r],u,e);if(o(207)!==r.type)return(e=(a=r.arg).value)&&o(181)==_typeof(e)&&s[o(235)](e,"__await")?c[o(227)](e[o(312)]).then(function(r){t(o(188),r,n,i)},function(r){t(o(207),r,n,i)}):c[o(227)](e)[o(282)](function(r){a.value=r,n(a)},function(r){return t(o(207),r,n,i)});i(r.arg)}(e,n,r,t)})}return t=t?t.then(r,r):r()}}function m(r){var t=f,e={tryLoc:r[0]};1 in r&&(e[t(218)]=r[1]),2 in r&&(e.finallyLoc=r[2],e[t(252)]=r[3]),this.tryEntries[t(182)](e)}function x(r){var t=f,e=r.completion||{};e[t(324)]=t(319),delete e[t(242)],r[t(232)]=e}function k(r){var t=f;this[t(275)]=[{tryLoc:"root"}],r.forEach(m,this),this[t(208)](!0)}function w(e){var n=f;if(e){var i,r=e[a];if(r)return r[n(235)](e);if(n(197)==typeof e.next)return e;if(!isNaN(e[n(178)]))return i=-1,(r=function r(){for(var t=n;++i<e.length;)if(s[t(235)](e,i))return r[t(260)]=e[i],r[t(210)]=!1,r;return r[t(260)]=void 0,r.done=!0,r}).next=r}return{next:b}}function b(){return{value:void 0,done:!0}}return o[f(223)]=v,i(y,f(209),v),i(v,f(209),o),o[f(219)]=i(v,n,f(245)),u.isGeneratorFunction=function(r){var t=f,r=t(197)==typeof r&&r[t(209)];return!!r&&(r===o||"GeneratorFunction"===(r[t(219)]||r[t(288)]))},u.mark=function(r){var t=f;return Object.setPrototypeOf?Object[t(301)](r,v):(r[t(228)]=v,i(r,n,"GeneratorFunction")),r[t(223)]=Object[t(268)](y),r},u[f(261)]=function(r){return{__await:r}},_(d[f(223)]),i(d[f(223)],e,function(){return this}),u.AsyncIterator=d,u[f(198)]=function(r,t,e,n,i){var a=f,o=(void 0===i&&(i=Promise),new d(c(r,t,e,n),i));return u[a(296)](t)?o:o[a(188)]()[a(282)](function(r){var t=a;return r[t(210)]?r[t(260)]:o.next()})},_(y),i(y,n,f(174)),i(y,a,function(){return this}),i(y,f(313),function(){return"[object Generator]"}),u[f(196)]=function(n){var r,i=f,a=[];for(r in n)a[i(182)](r);return a[i(315)](),function r(){for(var t=i;a.length;){var e=a.pop();if(e in n)return r[t(260)]=e,r[t(210)]=!1,r}return r[t(210)]=!0,r}},u[f(195)]=w,k.prototype={constructor:k,reset:function(r){var t=f;if(this.prev=0,this[t(188)]=0,this.sent=this[t(277)]=void 0,this[t(210)]=!1,this[t(236)]=null,this[t(221)]="next",this.arg=void 0,this.tryEntries[t(280)](x),!r)for(var e in this)"t"===e.charAt(0)&&s[t(235)](this,e)&&!isNaN(+e[t(309)](1))&&(this[e]=void 0)},stop:function(){var r=f,t=(this[r(210)]=!0,this[r(275)][0][r(232)]);if(r(207)===t[r(324)])throw t[r(242)];return this[r(186)]},dispatchException:function(n){var i=f;if(this[i(210)])throw n;var a=this;function r(r,t){var e=i;return o[e(324)]=e(207),o.arg=n,a[e(188)]=r,t&&(a[e(221)]=e(188),a[e(242)]=void 0),!!t}for(var t=this[i(275)][i(178)]-1;0<=t;--t){var e=this.tryEntries[t],o=e.completion;if(i(255)===e[i(265)])return r(i(257));if(e.tryLoc<=this[i(272)]){var u=s[i(235)](e,i(218)),c=s[i(235)](e,i(213));if(u&&c){if(this[i(272)]<e.catchLoc)return r(e[i(218)],!0);if(this[i(272)]<e.finallyLoc)return r(e.finallyLoc)}else if(u){if(this[i(272)]<e[i(218)])return r(e.catchLoc,!0)}else{if(!c)throw new Error("try statement without catch or finally");if(this[i(272)]<e[i(213)])return r(e[i(213)])}}}},abrupt:function(r,t){for(var e=f,n=this[e(275)][e(178)]-1;0<=n;--n){var i=this[e(275)][n];if(i[e(265)]<=this[e(272)]&&s[e(235)](i,e(213))&&this[e(272)]<i[e(213)]){var a=i;break}}var o=(a=a&&(e(216)===r||e(250)===r)&&a[e(265)]<=t&&t<=a.finallyLoc?null:a)?a[e(232)]:{};return o[e(324)]=r,o[e(242)]=t,a?(this[e(221)]=e(188),this[e(188)]=a[e(213)],p):this[e(244)](o)},complete:function(r,t){var e=f;if(e(207)===r[e(324)])throw r[e(242)];return e(216)===r[e(324)]||e(250)===r[e(324)]?this[e(188)]=r[e(242)]:"return"===r.type?(this[e(186)]=this[e(242)]=r.arg,this.method=e(200),this[e(188)]=e(257)):e(319)===r[e(324)]&&t&&(this[e(188)]=t),p},finish:function(r){for(var t=f,e=this[t(275)][t(178)]-1;0<=e;--e){var n=this.tryEntries[e];if(n[t(213)]===r)return this[t(244)](n[t(232)],n[t(252)]),x(n),p}},catch:function(r){for(var t=f,e=this[t(275)][t(178)]-1;0<=e;--e){var n,i,a=this[t(275)][e];if(a[t(265)]===r)return"throw"===(n=a[t(232)])[t(324)]&&(i=n.arg,x(a)),i}throw new Error(t(248))},delegateYield:function(r,t,e){var n=f;return this.delegate={iterator:w(r),resultName:t,nextLoc:e},n(188)===this.method&&(this[n(242)]=void 0),p}},u}function asyncGeneratorStep(r,t,e,n,i,a,o){var u=_0x2679;try{var c=r[a](o),s=c.value}catch(r){return void e(r)}c.done?t(s):Promise[u(227)](s)[u(282)](n,i)}function _asyncToGenerator(c){return function(){var r=this,u=arguments;return new Promise(function(t,e){var n=_0x2679,i=c[n(234)](r,u);function a(r){asyncGeneratorStep(i,t,e,a,o,n(188),r)}function o(r){asyncGeneratorStep(i,t,e,a,o,n(207),r)}a(void 0)})}}!function(){for(var r=_0x2679,t=_0x5a73();;)try{if(640628==-parseInt(r(285))+-parseInt(r(243))/2*(parseInt(r(270))/3)+-parseInt(r(202))/4+-parseInt(r(306))/5*(parseInt(r(191))/6)+parseInt(r(293))/7*(-parseInt(r(253))/8)+parseInt(r(231))/9*(-parseInt(r(258))/10)+parseInt(r(217))/11)break;t.push(t.shift())}catch(r){t.push(t.shift())}}();var fs=require("fs"),path=require(_0x33f082(220)),JsZip=require(_0x33f082(256)),AdmZip=require(_0x33f082(279)),_require=require(_0x33f082(254)),clearResource=_require[_0x33f082(266)],_require2=require(_0x33f082(287)),mkdirsSync=_require2[_0x33f082(269)],signUtils=require(_0x33f082(203)),REQUIRED_KEY=[_0x33f082(276),_0x33f082(321),_0x33f082(201),"encryptPassword"],REGEXP_ICON=/^{{\$t\('(.+)'\)}}$/g,MANIFEST="manifest.json",rpkOutPath="";function rpkHandler(p,l){var t,e;return new Promise((t=_0x2679,e=_asyncToGenerator(_regeneratorRuntime()[t(185)](function r(e,n){var i,a,o,u,c,s,f,h=t;return _regeneratorRuntime()[h(274)](function(r){for(var t=h;;)switch(r[t(272)]=r[t(188)]){case 0:if(fs[t(205)](p)){r[t(188)]=4;break}return r[t(271)]("return",n(new Error("Can not resolve rpk file: ".concat(p))));case 4:if(fs.existsSync(l)){r.next=6;break}return r.abrupt(t(200),n(new Error(t(325)[t(305)](l))));case 6:return r[t(188)]=8,getManifest(p);case 8:if(isNullObject(i=r[t(177)]))return r[t(271)](t(200),n(new Error(t(249))));r[t(188)]=11;break;case 11:if(u=path[t(183)](l),a=resolveFilePath(u,t(180)),o=null,a){r[t(188)]=18;break}if(isNullObject(o=getSignConfig(u)))return r[t(271)](t(200),n(new Error(t(323))));r[t(188)]=18;break;case 18:return u=i[t(294)],s=path[t(183)](p),s=path[t(230)](s,u),c=path.join(s,t(179)),s=path[t(230)](s,t(316)),r[t(188)]=25,extractRpk(p,c);case 25:return processFile(c),f={privKeyFilePath:a,certFilePath:l,projectSignCfg:o},r[t(188)]=29,repackRpk(i,s,c,f);case 29:return r[t(271)]("return",e(rpkOutPath));case 30:case t(257):return r.stop()}},r)})),function(r,t){return e.apply(this,arguments)}))}function _0x5a73(){var r=["wrap","tryEntries","keyId","_sent","readFileSync","adm-zip","forEach","getResources","then","Generator is already running","replace","599596uALoeu","generatePkgDef","../fa-compiler/utils","name","suspendedYield","projectSignCfg","writeFileSync","versionType","2023VswKLq","package","@@toStringTag","isGeneratorFunction","loadAsync","../common/icon-handler","toStringTag","_invoke","setPrototypeOf","sign","defineProperty","@@asyncIterator","concat","36715pnXbPz","getPrototypeOf","extractAllTo","slice","exports","hasOwnProperty","__await","toString","iterator","reverse","dist","_beta_","getSignInfo","normal","sync","userName","file","Missing private key or signature configuration.","type","Can not resolve certificate file: ","catch","Generator","versionName","every","sent","length","build","private.pem","object","push","dirname","quickapp.config.js","mark","rval","The iterator does not provide a 'throw' method","next","rpkBuffer","utf-8","546yVgiwj","executing","META-INF","glob","values","keys","function","async","stringify","return","passwordDigest","1575304VFoFEA","../../sign-tools/rpk-sign-utils","privKeyFilePath","existsSync","signPkgs","throw","reset","constructor","done","resultName",".rpk","finallyLoc","@@iterator","trim","break","61631460GQswhA","catchLoc","displayName","path","method","string","prototype","iterator result is not an object","includes","completed","resolve","__proto__","nextLoc","join","9RUENBg","completion","suspendedStart","apply","call","delegate","addResourceToPkg","stop","asyncIterator","manifest.json","/*.json","arg","429746iWAaHB","complete","GeneratorFunction","match","certFilePath","illegal catch attempt","Invalid rpk file.","continue","quickapp.config.json","afterLoc","29512dNcSmS","../common/utils","root","jszip","end","11601110zoxMgf","icon","value","awrap","reduce","beta","parse","tryLoc","clearResource","files","create","mkdirsSync","15ogkxRV","abrupt","prev","symbol"];return(_0x5a73=function(){return r})()}function repackRpk(r,t,e,n){return _repackRpk[_0x33f082(234)](this,arguments)}function _repackRpk(){return(_repackRpk=_asyncToGenerator(_regeneratorRuntime().mark(function r(e,n,i,a){var o,u,c,s,f,h,p=_0x2679;return _regeneratorRuntime()[p(274)](function(r){for(var t=p;;)switch(r[t(272)]=r[t(188)]){case 0:return mkdirsSync(n),o=e.package,u=e[t(175)],f=a[t(204)],h=a[t(247)],s=a[t(290)],h=fs.readFileSync(h),f=s?s.keyId:fs.readFileSync(f),h=signUtils[t(318)](h,f,s),f=signUtils[t(281)](i),s=signUtils[t(286)]([]),c=s.mainPkg,s=s.subPkgs,signUtils[t(237)](f,i,c,s),r[t(188)]=11,signUtils[t(206)](o,h,c,s);case 11:f=r[t(177)],h=f[t(189)],rpkOutPath=path[t(230)](n,""[t(305)](o,t(317))[t(305)](u,t(212))),fs.writeFileSync(rpkOutPath,h);case 15:case t(257):return r[t(238)]()}},r)}))).apply(this,arguments)}function getManifest(r){return _getManifest[_0x33f082(234)](this,arguments)}function _getManifest(){var t=_0x33f082;return(_getManifest=_asyncToGenerator(_regeneratorRuntime()[t(185)](function r(e){var n,i,a=t;return _regeneratorRuntime()[a(274)](function(r){for(var t=a;;)switch(r[t(272)]=r[t(188)]){case 0:return n=new JsZip,r[t(188)]=3,n[t(297)](fs.readFileSync(e));case 3:if((i=r.sent)&&i[t(267)][MANIFEST]){r.next=6;break}return r[t(271)](t(200),{});case 6:return r[t(188)]=8,n[t(322)](MANIFEST)[t(198)](t(222));case 8:return i=r.sent,r[t(271)](t(200),JSON.parse(i)||{});case 10:case t(257):return r[t(238)]()}},r)})))[t(234)](this,arguments)}function getSignConfig(r){for(var t=_0x33f082,e=path[t(230)](r,".."),n=[t(251),t(184)],i={},a=0;a<n[t(178)];a++){var o=resolveFilePath(e,n[a]);if(fs[t(205)](o)){i=require(o);break}}return checkSignCfg(i)?i[t(302)]:{}}function checkSignCfg(r){var e,n=_0x33f082;return!(!r||!r[n(302)])&&(e=r[n(302)],REQUIRED_KEY[n(176)](function(r){var t=n;return Object.keys(e)[t(225)](r)&&e[r]}))}function resolveFilePath(r,t){var e=_0x33f082,n=2<arguments[e(178)]&&void 0!==arguments[2]?arguments[2]:1,i=path[e(230)](r,t);return fs[e(205)](i)?i:n<2?resolveFilePath(path[e(230)](r,".."),t,n+1):""}function isNullObject(r){var t=_0x33f082;return 0===Object.keys(r)[t(178)]}function processFile(r){var t=_0x33f082,e=path[t(230)](r,t(240)),n=JSON[t(264)](fs.readFileSync(e,t(190))),i=(n[t(292)]=t(263),fs[t(291)](e,JSON[t(199)](n,null,2)),getLogoPath(n[t(259)],r));if(0<i[t(178)])for(var a=require(t(298)).addWatermark,o=0;o<i[t(178)];o++){var u=i[o];a(u,u)}}function getLogoPath(r,n){var i=_0x33f082,r=r[i(215)]()||"";if(!r[i(246)](REGEXP_ICON))return[path[i(230)](n,r)];var t=path[i(230)](n,"i18n");if(!fs[i(205)](t))return[];var e=require(i(194)),a=r[i(284)](REGEXP_ICON,"$1");return e[i(320)](""[i(305)](t,i(241)))[i(262)](function(r,t){var e=i,t=JSON[e(264)](fs[e(278)](t,"utf8"));return t[a]&&r[e(182)](path[e(230)](n,t[a])),r},[])}function extractRpk(r,t){return _extractRpk[_0x33f082(234)](this,arguments)}function _extractRpk(){var r=_0x33f082;return(_extractRpk=_asyncToGenerator(_regeneratorRuntime().mark(function r(e,n){var i,a=_0x2679;return _regeneratorRuntime()[a(274)](function(r){for(var t=a;;)switch(r[t(272)]=r[t(188)]){case 0:return r[t(188)]=2,clearResource([path[t(183)](n)]);case 2:return mkdirsSync(n),r[t(272)]=3,new AdmZip(e)[t(308)](n,!0),i=path[t(230)](n,t(193)),r.next=9,clearResource([i]);case 9:r[t(188)]=14;break;case 11:throw r[t(272)]=11,r.t0=r[t(326)](3),r.t0;case 14:case"end":return r[t(238)]()}},r,null,[[3,11]])})))[r(234)](this,arguments)}module[_0x33f082(310)]={rpkHandler:rpkHandler};